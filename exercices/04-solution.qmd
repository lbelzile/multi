---
title: "Régression logistique"
execute:
  echo: true
  eval: true
  message: false
  warning: false
  error: false
---


## Exercice 4.1

*Les données `logistclient` contiennent des données simulées pour un cas fictif de promotion pour des clients.*

1. *Estimez le modèle logistique pour la probabilité que `promo=1` avec les variables explicatives `nachats`, `sexe` et `tclient`.*

```{r}
data(logistclient, package = "hecmulti")
# Modèle logistique
mod <- glm(promo ~ nachats + sexe + tclient, 
           family = binomial(link = "logit"),
           data = logistclient)
# Coefficients du modèle et statistique de Wald
summary(mod)
```



2. *Interprétez les coefficients du modèle à l'échelle de la cote en terme de pourcentage d'augmentation ou de diminution.*

```{r}
exp(coef(mod)) # Cote
```

- La cote pour l'offre promotionnelle (oui versus non) des hommes est 23.5% plus faible que celle des femmes, *ceteris paribus*
- Le rapport de cotes pour `tclient` fréquent/occasionnel est 0.934: les clients fréquents ont une cote 6.6% inférieure à celle des clients occasionnels, toute chose étant égale par ailleurs. De manière équivalente, la cote des clients occasionnels est 7.11% supérieure à celle des clients fréquents, *ceteris paribus*.
- La cote de `nachats` augmente de 23.1% pour chaque augmentation du nombre d'achats dans le dernier mois,  *ceteris paribus*
 

3. *Testez si l'effet de `nachats` est statistiquement significatif à niveau $\alpha = 0.05$.*

- L'intervalle de confiance à 95% pour le rapport de cote de `nachats`, basé sur la vraisemblance profilée, est de $[1.15, 1.32]$; comme 1 est exclu, cette différence est statistiquement significative. 

On obtiendrait la même conclusion avec la statistique du test de rapport de vraisemblance, ici $37.237$ pour 1 degré de liberté. La probabilité, si $\beta_{\text{nachats}}=0$, d'obtenir une telle différence d'ajustement est inférieure à $10^{-4}$, bien en deça du seuil de significativité. On rejette l'hypothèse nulle et on conclut que le nombre d'achat est important pour expliquer si une personne s'est prévalue de l'offre promotionnelle.

```{r}
exp(confint(mod)) #IC pour rapport de cote
car::Anova(mod, type = 3) # tests de rapport de vraisemblance
```
