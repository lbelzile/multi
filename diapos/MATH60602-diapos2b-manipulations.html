<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Manipuler des bases de données avec dplyr</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrew Heiss, Léo Belzile (adaptation et traduction)" />
    <script src="libs/header-attrs-2.18/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view-0.2.6/tile-view.js"></script>
    <script src="libs/clipboard-2.0.6/clipboard.min.js"></script>
    <link href="libs/shareon-1.4.1/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon-1.4.1/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain-0.2.6/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain-0.2.6/shareagain.js"></script>
    <link href="libs/countdown-0.4.0/countdown.css" rel="stylesheet" />
    <script src="libs/countdown-0.4.0/countdown.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/ath-slides.css" type="text/css" />
    <link rel="stylesheet" href="css/ath-inferno-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">








class: center middle main-title section-title-1

# Manipuler des&lt;br&gt;bases de données&lt;br&gt;avec `dplyr`

.class-info[
&lt;figure&gt;
  &lt;img src="img/04/dplyr.png" alt="dplyr" title="dplyr" width="15%"&gt;
&lt;/figure&gt;
]


---

layout: false
class: title title-1 section-title-inv-1

# À votre tour #0: chargez les données

1. Compilez le bloc `setup`
2. Jetez un coup d'oeil aux données `gapminder`

<div class="countdown" id="timer_cdfb492a" data-update-every="1" data-play-sound="true" tabindex="0" style="right:0;bottom:0;font-size:1.5em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">02</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

.small[

```r
gapminder
```

```
## # A tibble: 1,704 × 6
##    country     continent  year lifeExp      pop gdpPercap
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1 Afghanistan Asia       1952    28.8  8425333      779.
##  2 Afghanistan Asia       1957    30.3  9240934      821.
##  3 Afghanistan Asia       1962    32.0 10267083      853.
##  4 Afghanistan Asia       1967    34.0 11537966      836.
##  5 Afghanistan Asia       1972    36.1 13079460      740.
##  6 Afghanistan Asia       1977    38.4 14880372      786.
##  7 Afghanistan Asia       1982    39.9 12881816      978.
##  8 Afghanistan Asia       1987    40.8 13867957      852.
##  9 Afghanistan Asia       1992    41.7 16317921      649.
## 10 Afghanistan Asia       1997    41.8 22227415      635.
## # … with 1,694 more rows
```
]

---

class: title title-1

# tidyverse

&lt;figure&gt;
  &lt;img src="img/02/tidyverse-language.png" alt="tidyverse and language" title="tidyverse and language" width="100%"&gt;
&lt;/figure&gt;

???

From "Master the Tidyverse" by RStudio

---

class: title title-1

# tidyverse

.center[
&lt;figure&gt;
  &lt;img src="img/02/tidyverse.png" alt="The tidyverse" title="The tidyverse" width="50%"&gt;
&lt;/figure&gt;
]

---

class: title title-1

# `dplyr`: verbes pour manipuler des données

&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;Extraire des lignes avec &lt;code&gt;filter()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/filter.png" alt="filter" title="filter" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Extraire des colonnes avec &lt;code&gt;select()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/select.png" alt="select" title="select" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Arranger/trier les lignes avec &lt;code&gt;arrange()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/arrange.png" alt="arrange" title="arrange" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Créer/modifier des colonnes avec &lt;code&gt;mutate()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/mutate.png" alt="mutate" title="mutate" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Résumer des sous-ensembles avec&lt;br&gt;&lt;code&gt;group_by() |&gt; summarize()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/summarize.png" alt="summarize" title="summarize" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

class: center middle section-title section-title-1

# `filter()`

---

layout: false
class: title title-1

# `filter()`

.box-inv-1[Extraire des lignes selon une condition logique]

.pull-left[

&lt;code class ='r hljs remark-code'&gt;filter(.data = &lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;DATA&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;...&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]

.pull-right[
- &lt;b&gt;&lt;span style="background: #FFDFD1"&gt;`DATA`&lt;/span&gt;&lt;/b&gt; = tableau de données à transformer
- &lt;b&gt;&lt;span style="background: #FFD0CF"&gt;`...`&lt;/span&gt;&lt;/b&gt; = Un ou plusieurs tests&lt;br&gt;.small[`filter()` retourne chaque ligne pour lequel le test retourne `TRUE`]
]

---


&lt;code class ='r hljs remark-code'&gt;filter(.data = &lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;country == "Denmark"&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1952 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1957 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1962 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1967 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1972 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1962 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1967 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1972 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1977 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

class: title title-1

# `filter()`

.pull-left[

&lt;code class ='r hljs remark-code'&gt;filter(.data = &lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;country == "Denmark"&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]

.pull-right[
.box-inv-1[Un signe `=`&lt;br&gt; pour l'assignation d'un argument]

.box-inv-1[Deux signes `==`&lt;br&gt;teste l'égalité entre objets&lt;br&gt;.small[retourne TRUE ou FALSE)]]
]

---

class: title title-1

# Tests logiques

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-center"&gt;Teste&lt;/th&gt;
    &lt;th class="cell-left"&gt;Signification&lt;/th&gt;
    &lt;th class="cell-center"&gt;Test&lt;/th&gt;
    &lt;th class="cell-left"&gt;Signification&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x &lt; y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;plus petit que&lt;/td&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x %in% y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;dans (élément d'un vecteur)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x &gt; y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;plus grand que&lt;/td&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;is.na(x)&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;valeur manquante?&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;==&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;égale&lt;/td&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;!is.na(x)&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;valeurs non manquantes&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x &lt;= y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;plus petit ou égal à&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x &gt;= y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;plus grand ou égal à&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x != y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;différent de&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

class: title title-1 section-title-inv-1

# À votre tour #1: filtrer

.box-1[Utilisez `filter()` et des tests logiques pour montrer…]

1. Les données du Canada
2. Toutes les données de pays situés en Océanie (Oceania)
3. Lignes où l'espérance de vie est supérieure à 82 ans

<div class="countdown" id="timer_cab800cb" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

.medium[

```r
filter(gapminder, country == "Canada")
```
]

--

.medium[

```r
filter(gapminder, continent == "Oceania")
```
]

--

.medium[

```r
filter(gapminder, lifeExp &gt; 82)
```
]

---

class: title title-1

# Erreur fréquente

.pull-left[
.box-inv-1[Utiliser `=` plutôt que `==`]


&lt;code class ='r hljs remark-code'&gt;filter(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;country &lt;b&gt;&lt;span style='color:#FF4136'&gt;=&lt;/span&gt;&lt;/b&gt; "Canada")&lt;/code&gt;


&lt;code class ='r hljs remark-code'&gt;filter(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;country &lt;b&gt;&lt;span style='color:#2ECC40'&gt;==&lt;/span&gt;&lt;/b&gt; "Canada")&lt;/code&gt;
]

--

.pull-right[
.box-inv-1[Mettre entre accolade]


&lt;code class ='r hljs remark-code'&gt;filter(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;country == &lt;b&gt;&lt;span style='color:#FF4136'&gt;Canada&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;


&lt;code class ='r hljs remark-code'&gt;filter(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;country == &lt;b&gt;&lt;span style='color:#2ECC40'&gt;"Canada"&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]

---

class: title title-1

# `filter()` avec des conditions multiples

.box-inv-1[Extrait les lignes qui valident *tous* les énoncés]


&lt;code class ='r hljs remark-code'&gt;filter(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;country == "Denmark", year &gt; 2000&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

---


&lt;code class ='r hljs remark-code'&gt;filter(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;country == "Denmark", year &gt; 2000&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1952 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1957 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1962 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1967 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1972 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2002 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

class: title title-1

# Opérateurs logiques

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-center"&gt;Opérateur&lt;/th&gt;
    &lt;th class="cell-center"&gt;Signification&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;a &amp; b&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-center"&gt;et&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;a | b&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-center"&gt;ou&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;!a&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-center"&gt;pas&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

class: title title-1

# Par défaut, union ("et")

.box-inv-1[Commandes équivalentes]


&lt;code class ='r hljs remark-code'&gt;filter(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;country == "Denmark", year &gt; 2000&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;


&lt;code class ='r hljs remark-code'&gt;filter(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;country == "Denmark" &amp; year &gt; 2000&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

---

class: title title-1 section-title-inv-1

# À votre tour #2: filtrer

.box-1[Utilisez `filter()` et les opérateurs logiques pour montrer…]

1. Les données du Canada avant 1970
2. Les pays où l'espérance de vie en 2007 est inférieure à 50
3. Les pays hors d'Afrique où l'espérance de vie en 2007 est inférieur à 50

<div class="countdown" id="timer_f5404840" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">04</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---


```r
filter(gapminder, country == "Canada", year &lt; 1970)
```

--


```r
filter(gapminder, year == 2007, lifeExp &lt; 50)
```

--


```r
filter(gapminder, year == 2007, lifeExp &lt; 50, 
       continent != "Africa")
```

---

class: title title-1

# Erreurs fréquentes

.pull-left[
.box-inv-1[Rassembler plusieurs conditions&lt;br&gt;en une seule]

.small-code[

&lt;code class ='r hljs remark-code'&gt;filter(gapminder, &lt;b&gt;&lt;span style='color:#FF4136'&gt;1960 &amp;lt; year &amp;lt; 1980&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]

.small-code[

&lt;code class ='r hljs remark-code'&gt;filter(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='color:#2ECC40'&gt;year &gt; 1960, year &amp;lt; 1980&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]
]

--

.pull-right[
.box-inv-1[Utiliser plusieurs tests&lt;br&gt; plutôt que `%in%`]

.small-code[

&lt;code class ='r hljs remark-code'&gt;filter(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='color:#FF4136'&gt;country == "Mexico", &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;country == "Canada", &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;country == "United States"&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]

.small-code[

&lt;code class ='r hljs remark-code'&gt;filter(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='color:#2ECC40'&gt;country %in% c("Mexico", "Canada", &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"United States")&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]
]

---

class: title title-1

# Syntaxe commune

.box-inv-1[Chaque verbe de `dplyr` a la même syntaxe]

.box-inv-1[Base de données comme premier argument, retourne une base de données]

.pull-left[

&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#EFB3FF'&gt;VERB&lt;/span&gt;&lt;/b&gt;(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;DATA&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;...&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]

.pull-right[
- &lt;b&gt;&lt;span style="background: #EFB3FF"&gt;`VERB`&lt;/span&gt;&lt;/b&gt; = fonction `dplyr`/verbe
- &lt;b&gt;&lt;span style="background: #FFDFD1"&gt;`DATA`&lt;/span&gt;&lt;/b&gt; = base de données à transformer
- &lt;b&gt;&lt;span style="background: #FFD0CF"&gt;`...`&lt;/span&gt;&lt;/b&gt; = commandes pour le verbe
]

---

class: title title-1

# `mutate()`

.box-inv-1[Créer de nouvelles colonnes]

.pull-left[

&lt;code class ='r hljs remark-code'&gt;mutate(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;.data&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;...&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]

.pull-right[
- &lt;b&gt;&lt;span style="background: #FFDFD1"&gt;`DATA`&lt;/span&gt;&lt;/b&gt; = base de données à transformer
- &lt;b&gt;&lt;span style="background: #FFD0CF"&gt;`...`&lt;/span&gt;&lt;/b&gt; = colonnes à modifier/créer
]

---


&lt;code class ='r hljs remark-code'&gt;mutate(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;gdp = gdpPercap * pop&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 779.4453145 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8425333 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 820.8530296 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9240934 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 853.10071 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10267083 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 836.1971382 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11537966 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 739.9811058 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 13079460 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; … &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdp &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6567086330 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7585448670 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8758855797 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9648014150 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9678553274 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1977 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11697659231 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---


&lt;code class ='r hljs remark-code'&gt;mutate(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;gdp = gdpPercap * pop,&lt;/span&gt;&lt;/b&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;pop_mil = round(pop / 1000000)&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 779.4453145 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8425333 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 820.8530296 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9240934 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 853.10071 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10267083 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 836.1971382 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11537966 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 739.9811058 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 13079460 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; … &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop_mil &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6567086330 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7585448670 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8758855797 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9648014150 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9678553274 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1977 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11697659231 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

class: title title-1

# `ifelse()`

.box-inv-1[Effectuer des tests conditionnels]

.pull-left[

&lt;code class ='r hljs remark-code'&gt;ifelse(&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;TEST&lt;/span&gt;&lt;/b&gt;, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;VALEUR_SI_TRUE&lt;/span&gt;&lt;/b&gt;, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#CBB5FF'&gt;VALEUR_SI_FALSE&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;
]

.pull-right[
- &lt;b&gt;&lt;span style="background: #FFC0DC"&gt;`TEST`&lt;/span&gt;&lt;/b&gt; = un test logique
- &lt;b&gt;&lt;span style="background: #FFDFD1"&gt;`VALEUR_SI_TRUE`&lt;/span&gt;&lt;/b&gt; = valeur si vrai
- &lt;b&gt;&lt;span style="background: #CBB5FF"&gt;`VALUE_IF_FALSE`&lt;/span&gt;&lt;/b&gt; = valeur si faux
]

.box-inv-1[
Vecteur en sortie de la longueur de &lt;b&gt;`TEST`&lt;/b&gt;
]

---



&lt;code class ='r hljs remark-code'&gt;mutate(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;after_1960 = &lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;year &gt; 1960&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;


&lt;code class ='r hljs remark-code'&gt;mutate(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;after_1960 = ifelse(&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;year &gt; 1960&lt;/span&gt;&lt;/b&gt;, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;"After 1960"&lt;/span&gt;&lt;/b&gt;, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#CBB5FF'&gt;"Before 1960"&lt;/span&gt;&lt;/b&gt;))&lt;/code&gt;

---


&lt;code class ='r hljs remark-code'&gt;mutate(gapminder, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;after_1960 = &lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;year &gt; 1960&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;



```
## # A tibble: 1,704 × 7
##    country     continent  year lifeExp      pop gdpPercap after_1960
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;lgl&gt;     
##  1 Afghanistan Asia       1952    28.8  8425333      779. FALSE     
##  2 Afghanistan Asia       1957    30.3  9240934      821. FALSE     
##  3 Afghanistan Asia       1962    32.0 10267083      853. TRUE      
##  4 Afghanistan Asia       1967    34.0 11537966      836. TRUE      
##  5 Afghanistan Asia       1972    36.1 13079460      740. TRUE      
##  6 Afghanistan Asia       1977    38.4 14880372      786. TRUE      
##  7 Afghanistan Asia       1982    39.9 12881816      978. TRUE      
##  8 Afghanistan Asia       1987    40.8 13867957      852. TRUE      
##  9 Afghanistan Asia       1992    41.7 16317921      649. TRUE      
## 10 Afghanistan Asia       1997    41.8 22227415      635. TRUE      
## # … with 1,694 more rows
```

---
class: title title-1

# `case_when()`

.box-inv-1[Tests conditionnels vectorisés]


```r
case_when(CAS1_EST_VRAI ~ VALEUR1, 
          CAS2_EST_VRAI ~ VALEUR2,
          TRUE ~ VALEUR_AUTRE)
```


.box-inv-1[Énoncés évalués si les précédents ne sont pas vrais.]


.box-inv-1[Retourne `NA` pour toute valeur restante si on omet le dernier énoncé]

---




```r
mutate(gapminder, 
       decennie = case_when(
         year &lt; 1960 ~ "années 50",
         year &gt;= 1960 &amp; year &lt; 1970 ~ "années 60",
         year &gt;= 1970 &amp; year &lt; 1980 ~ "années 70",
         year &gt;= 1980 &amp; year &lt; 1990 ~ "années 80",
         year &gt;= 1990 &amp; year &lt; 2000 ~ "années 90",
         TRUE ~ "millénaire")
)
```

---



```
## # A tibble: 1,704 × 7
##    country     continent  year lifeExp      pop gdpPercap decennie 
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    
##  1 Afghanistan Asia       1952    28.8  8425333      779. années 50
##  2 Afghanistan Asia       1957    30.3  9240934      821. années 50
##  3 Afghanistan Asia       1962    32.0 10267083      853. années 60
##  4 Afghanistan Asia       1967    34.0 11537966      836. années 60
##  5 Afghanistan Asia       1972    36.1 13079460      740. années 70
##  6 Afghanistan Asia       1977    38.4 14880372      786. années 70
##  7 Afghanistan Asia       1982    39.9 12881816      978. années 80
##  8 Afghanistan Asia       1987    40.8 13867957      852. années 80
##  9 Afghanistan Asia       1992    41.7 16317921      649. années 90
## 10 Afghanistan Asia       1997    41.8 22227415      635. années 90
## # … with 1,694 more rows
```

---

class: title title-1 section-title-inv-1

# À votre tour #3: transformer

.box-1[Utilisez `mutate()` pour ajouter les colonnes…]

1. `africa`, qui est vrai (`TRUE`) si le pays est situé sur le continent africain
2. `log_gdpPercap` pour le log PIB par capita (indice: utiliser `log()`)
3. `africa_asia` avec comme valeur `"Afrique ou Asie"` si le pays est dans un des deux continents, sinon `"Autre continent"`

<div class="countdown" id="timer_63970631" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---


```r
mutate(gapminder, 
       africa = continent == "Africa")
```

--


```r
mutate(gapminder, 
       log_gdpPercap = log(gdpPercap))
```

--


```r
mutate(gapminder, 
       africa_asia = ifelse(continent %in% c("Africa", "Asia"),
                            "Afrique ou Asie",
                            "Autre continent"))
```

---

class: title title-1

# Comment procéder avec plusieurs verbes?

.box-inv-1.sp-after[Créer un jeu de données pour 2002 *et* calculer le log PIB par capita]

--

.box-inv-1[Solution 1: variables auxiliaires]


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;gapminder_2002&lt;/span&gt;&lt;/b&gt; &lt;- filter(gapminder, year == 2002)&lt;br&gt;&lt;br&gt;&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;gapminder_2002&lt;/span&gt;&lt;/b&gt;_log &lt;- mutate(&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;gapminder_2002&lt;/span&gt;&lt;/b&gt;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;log_gdpPercap = log(gdpPercap))&lt;/code&gt;

---

class: title title-1

# Comment procéder avec plusieurs verbes?


.box-inv-1.sp-after[Créer un jeu de données pour 2002 *et* calculer le log PIB par capita]

.box-inv-1[Solution 2: fonctions emboîtées]


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;filter(&lt;/span&gt;&lt;/b&gt;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;mutate(gapminder_2002,&lt;/span&gt;&lt;/b&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;log_gdpPercap = log(gdpPercap))&lt;/span&gt;&lt;/b&gt;, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;year == 2002)&lt;/span&gt;&lt;/b&gt;&lt;/code&gt;

---

class: title title-1

#  Comment procéder avec plusieurs verbes?

.box-inv-1.sp-after[Créer un jeu de données pour 2002 *et* calculer le log PIB par capita]

.box-inv-1[Solution 3: tuyaux!]

.box-inv-1[L'opérateur tuyau, `|&gt;`, prend un objet à gauche&lt;br&gt;et l'assigne au premier argument de la fonction de droite]


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;gapminder&lt;/span&gt;&lt;/b&gt; |&gt; filter(&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;_____&lt;/span&gt;&lt;/b&gt;, country == "Canada")&lt;/code&gt;

---

class: title title-1

# Comment procéder avec plusieurs verbes?

.box-inv-1[Ces deux lignes donnent le même résultat]


&lt;code class ='r hljs remark-code'&gt;filter(&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;gapminder&lt;/span&gt;&lt;/b&gt;, country == "Canada")&lt;/code&gt;


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFC0DC'&gt;gapminder&lt;/span&gt;&lt;/b&gt; |&gt; filter(country == "Canada")&lt;/code&gt;

---

class: title title-1

# Comment procéder avec plusieurs verbes?

.box-inv-1.sp-after[Créer un jeu de données pour 2002 *et* calculer le log PIB par capita]


.box-inv-1[Solution 3: Tuyaux!]


&lt;code class ='r hljs remark-code'&gt;gapminder |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;filter(year == 2002) |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;mutate(log_gdpPercap = log(gdpPercap))&lt;/code&gt;

---

class: title title-1

# Améliorer la lisibilité du code avec `|&gt;`


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;leave_house&lt;/b&gt;(&lt;b&gt;get_dressed&lt;/b&gt;(&lt;b&gt;get_out_of_bed&lt;/b&gt;(&lt;b&gt;wake_up&lt;/b&gt;(&lt;span style='color:#E16462'&gt;me&lt;/span&gt;, &lt;span style='color:#0D0887'&gt;time&lt;/span&gt; = &lt;span style='color:#E16462'&gt;"8:00"&lt;/span&gt;), &lt;span style='color:#0D0887'&gt;side&lt;/span&gt; = &lt;span style='color:#E16462'&gt;"correct"&lt;/span&gt;), &lt;span style='color:#0D0887'&gt;pants&lt;/span&gt; = &lt;span style='color:#E16462'&gt;TRUE&lt;/span&gt;, &lt;span style='color:#0D0887'&gt;shirt&lt;/span&gt; = &lt;span style='color:#E16462'&gt;TRUE&lt;/span&gt;), &lt;span style='color:#0D0887'&gt;car&lt;/span&gt; = &lt;span style='color:#E16462'&gt;TRUE&lt;/span&gt;, &lt;span style='color:#0D0887'&gt;bike&lt;/span&gt; = &lt;span style='color:#E16462'&gt;FALSE&lt;/span&gt;)&lt;/code&gt;

--


&lt;code class ='r hljs remark-code'&gt;me |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;&lt;b&gt;wake_up&lt;/b&gt;(&lt;span style='color:#0D0887'&gt;time&lt;/span&gt; = &lt;span style='color:#E16462'&gt;"8:00"&lt;/span&gt;) |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;&lt;b&gt;get_out_of_bed&lt;/b&gt;(&lt;span style='color:#0D0887'&gt;side&lt;/span&gt; = &lt;span style='color:#E16462'&gt;"correct"&lt;/span&gt;) |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;&lt;b&gt;get_dressed&lt;/b&gt;(&lt;span style='color:#0D0887'&gt;pants&lt;/span&gt; = &lt;span style='color:#E16462'&gt;TRUE&lt;/span&gt;, &lt;span style='color:#0D0887'&gt;shirt&lt;/span&gt; = &lt;span style='color:#E16462'&gt;TRUE&lt;/span&gt;) |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;&lt;b&gt;leave_house&lt;/b&gt;(&lt;span style='color:#0D0887'&gt;car&lt;/span&gt; = &lt;span style='color:#E16462'&gt;TRUE&lt;/span&gt;, &lt;span style='color:#0D0887'&gt;bike&lt;/span&gt; = &lt;span style='color:#E16462'&gt;FALSE&lt;/span&gt;)&lt;/code&gt;

---

class: title title-1

# `summarize()`

.box-inv-1[Créer un tableau résumé]


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt; |&gt; summarize(&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;mean_life = mean(lifeExp)&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; lifeExp &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 28.801 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 30.332 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 31.997 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 34.02 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; mean_life &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 59.47444 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

class: title title-1

# `summarize()`


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt; |&gt; summarize(&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;mean_life = mean(lifeExp),&lt;/span&gt;&lt;/b&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;min_life = min(lifeExp)&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; lifeExp &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 28.801 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 30.332 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 31.997 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 34.02 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 36.088 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; mean_life &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; min_life &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 59.47444 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23.599 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

class: title title-1 section-title-inv-1

# À votre tour #4: résumer

.box-1[Utilisez `summarize()` pour calculer…]

1. La première année des mesures (minimum)
2. La dernière année des mesures (maximum) 
3. Le nombre de lignes dans la base de données (utilisez l'aide mémoire)
4. Le nombre de pays distincts dans la base de données (utilisez l'aide mémoire)

<div class="countdown" id="timer_064978a6" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">04</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---


```r
gapminder |&gt; 
  summarize(first = min(year),
            last = max(year),
            num_rows = n(),
            num_unique = n_distinct(country))
```

.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; first &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; last &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; num_rows &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; num_unique &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1704 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 142 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

class: title title-1 section-title-inv-1

# À votre tour #5: résumer

.box-1[Utilisez `filter()` et `summarize()` pour calculer]

1. le nombre de pays
2. l'espérance de vie médiane 

pour le continent africain en 2007.

<div class="countdown" id="timer_8b6b74f9" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">04</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---


```r
gapminder |&gt;
  filter(continent == "Africa", year == 2007) |&gt;
  summarise(n_countries = n_distinct(country), 
            med_le = median(lifeExp))
```

.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; n_countries &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; med_le &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 52 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.9265 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

class: title title-1

# `group_by()`

.box-inv-1[Assembler les lignes en groupes selon les valeurs d'une colonne]


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;gapminder&lt;/span&gt;&lt;/b&gt; |&gt; group_by(&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;continent&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

&amp;nbsp;

--

.box-inv-1[Rien n'apparaît!]

--

.box-inv-1[Outil puissant si combiné avec `summarize()`]

---


```r
gapminder |&gt; 
  group_by(continent) |&gt; 
  summarize(n_countries = n_distinct(country)) 
```

--

.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n_countries &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Americas &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 33 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Oceania &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---




&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;pollution&lt;/span&gt;&lt;/b&gt; |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;summarize(&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;mean = mean(amount), sum = sum(amount), n = n()&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; city &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; particle_size &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; amount &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; London &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; London &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Beijing &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 121 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Beijing &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 56 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; mean &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sum &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 252 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;pollution&lt;/span&gt;&lt;/b&gt; |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;group_by(&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;city&lt;/span&gt;&lt;/b&gt;) |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;summarize(&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;mean = mean(amount), sum = sum(amount), n = n()&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; city &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; particle_size &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; amount &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #B2B1F9 !important;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #B2B1F9 !important;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #B2B1F9 !important;"&gt; 23 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #B2B1F9 !important;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #B2B1F9 !important;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #B2B1F9 !important;"&gt; 14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #EFB3FF !important;"&gt; London &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #EFB3FF !important;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #EFB3FF !important;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #EFB3FF !important;"&gt; London &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #EFB3FF !important;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #EFB3FF !important;"&gt; 16 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFD0CF !important;"&gt; Beijing &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #FFD0CF !important;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFD0CF !important;"&gt; 121 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFD0CF !important;"&gt; Beijing &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #FFD0CF !important;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFD0CF !important;"&gt; 56 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; city &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mean &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sum &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFD0CF !important;"&gt; Beijing &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFD0CF !important;"&gt; 88.5 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFD0CF !important;"&gt; 177 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFD0CF !important;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #EFB3FF !important;"&gt; London &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #EFB3FF !important;"&gt; 19.0 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #EFB3FF !important;"&gt; 38 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #EFB3FF !important;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #B2B1F9 !important;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #B2B1F9 !important;"&gt; 18.5 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #B2B1F9 !important;"&gt; 37 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #B2B1F9 !important;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---


&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;pollution&lt;/span&gt;&lt;/b&gt; |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;group_by(&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;particle_size&lt;/span&gt;&lt;/b&gt;) |&gt; &lt;br&gt;&amp;nbsp;&amp;nbsp;summarize(&lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;mean = mean(amount), sum = sum(amount), n = n()&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

.pull-left.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; city &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; particle_size &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; amount &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFDFD1 !important;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #FFDFD1 !important;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFDFD1 !important;"&gt; 23 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFF0D4 !important;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #FFF0D4 !important;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFF0D4 !important;"&gt; 14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFDFD1 !important;"&gt; London &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #FFDFD1 !important;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFDFD1 !important;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFF0D4 !important;"&gt; London &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #FFF0D4 !important;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFF0D4 !important;"&gt; 16 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFDFD1 !important;"&gt; Beijing &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #FFDFD1 !important;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFDFD1 !important;"&gt; 121 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFF0D4 !important;"&gt; Beijing &lt;/td&gt;
   &lt;td style="text-align:left;background-color: #FFF0D4 !important;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFF0D4 !important;"&gt; 56 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; particle_size &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mean &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sum &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFDFD1 !important;"&gt; Large &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFDFD1 !important;"&gt; 55.33333 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFDFD1 !important;"&gt; 166 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFDFD1 !important;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: #FFF0D4 !important;"&gt; Small &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFF0D4 !important;"&gt; 28.66667 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFF0D4 !important;"&gt; 86 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: #FFF0D4 !important;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

class: title title-1 section-title-inv-1

# À votre tour #6: grouper et résumer

.box-1[Trouvez l'espérance de vie &lt;br&gt;minimum, maximum et médiane&lt;br&gt;par continent]

.box-1[Trouvez l'espérance de vie &lt;br&gt;minimum, maximum et médiane&lt;br&gt;par continent pour 2007 uniquement]

<div class="countdown" id="timer_e497c7d4" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---


```r
gapminder |&gt; 
  group_by(continent) |&gt; 
  summarize(min_le = min(lifeExp),
            max_le = max(lifeExp),
            med_le = median(lifeExp))
```

--


```r
gapminder |&gt; 
  filter(year == 2007) |&gt; 
  group_by(continent) |&gt; 
  summarize(min_le = min(lifeExp),
            max_le = max(lifeExp),
            med_le = median(lifeExp))
```

---

class: title title-1

# `dplyr`: verbes pour manipuler des données

&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;Extraire des lignes avec &lt;code&gt;filter()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/filter.png" alt="filter" title="filter" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Extraire des colonnes avec &lt;code&gt;select()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/select.png" alt="select" title="select" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Arranger/trier les lignes avec &lt;code&gt;arrange()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/arrange.png" alt="arrange" title="arrange" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Créer/modifier des colonnes avec &lt;code&gt;mutate()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/mutate.png" alt="mutate" title="mutate" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Résumer des sous-ensembles avec&lt;br&gt;&lt;code&gt;group_by() |&gt; summarize()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="img/04/summarize.png" alt="summarize" title="summarize" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9",
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
